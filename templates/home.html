{% include 'layout.html' %}

<div class="container mt-5">
    <!-- Header -->
    <h3 class="font-roboto-bold">
        Personal Chatbot
    </h3>
    <hr />

    <!-- Chat log -->
    <div id="chat-log" class="font-roboto overflow-auto">
        <div class="message-container">
            {% for message in chat_log %}
            <div class="row mx-2">
                {% if message['role'] == 'assistant' %}
                <div class="card chat-message message-assistant bg-secondary">
                    <h5 class="card-body text-white lh-base">{{ message['content'] }}</h5>
                </div>
                {% elif message['role'] == 'user' %}
                <div class="card chat-message message-user bg-primary">
                    <h5 class="card-body text-white lh-base">{{ message['content'] }}</h5>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Text input -->
    <form action="/" method="POST">
        <div id="chat-input">
            <textarea name="user_input" class="form-control" placeholder="Type message"></textarea>
            <button class="btn btn-primary rounded-4" type="submit">
                <span class="material-symbols-outlined">
                    send
                </span>
            </button>
        </div>
    </form>

    <!-- In-line script to scroll to bottom of chat log -->
    <script>
        let chat_window = document.querySelector("#chat-log")
        chat_window.scrollTo(0, chat_window.scrollHeight);
    </script>
</div>